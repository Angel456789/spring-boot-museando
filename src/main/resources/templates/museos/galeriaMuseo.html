<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Plataforma interactiva de experiencias culturales con tecnología IoT">
    <meta name="author" content="TuNombre">
    
    <title>Galería Museo</title>
    
    <link rel="icon" href="favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link th:href="@{/css/estilos.css}" rel="stylesheet">
    <link th:href="@{/css/galeria.css}" rel="stylesheet">
</head>

<body>
      <div class="d-flex flex-column min-vh-100">
    <!-- Barra de navegación -->
    <header th:insert="~{fragmentos/menu :: menu-principal}"></header>

    <!-- Contenido principal -->
    <main class="container my-5">
		<div class="galeria-contenedor">
		    <!-- Header simple -->
		    <div class="text-center mb-4">
		        <h2 class="galeria-titulo">Galería del Museo</h2>
				<h3 class="text-muted fs-4 fst-italic" th:text="${museo.nombre}">Museo de Arte Moderno</h3>
		    </div>

		    <!-- Formulario para subir nueva imagen -->
		    <form th:action="@{/galeria/guardar}" method="post" enctype="multipart/form-data" class="mb-4">
		        <input type="hidden" name="idMuseo" th:value="${museo.id}" />
		        <div class="input-group">
					<input type="file" 
					       name="archivoImagenes" 
					       class="form-control" 
					       multiple 
					       required
					       accept=".jpg,.jpeg,.png,.bmp,.webp" />
		            <button class="btn btn-primary" type="submit">Subir Imagen</button>
		        </div>
		    </form>

            <!-- Grid de imágenes simple -->
			<div class="row g-4">
				<div class="col-6 col-md-4 col-lg-2" th:each="imagen : ${imagenes}">
			    <div class="galeria-item-simple">
					<img th:src="@{'/galeria/' + ${imagen.imagen}}" 
					     class="img-fluid galeria-imagen-simple" 
					     th:alt="${imagen.imagen}" 
					     data-bs-toggle="modal" data-bs-target="#imageModal" 
					     th:data-img="@{'/galeria/' + ${imagen.imagen}}">
			      <div class="galeria-overlay-simple">
			        <a th:href="@{'/galeria/eliminar/' + ${imagen.id} + '/' + ${museo.id}}" 
			           class="btn btn-danger btn-sm"
			           onclick="return confirm('¿Está seguro que desea eliminar esta imagen?');">
			           <i class="fas fa-trash"></i>
			        </a>
			      </div>
			    </div>
			  </div>
			</div>

        </div>
    </main>

    <!-- Modal para vista de imagen -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center p-0">
                    <img src="" class="img-fluid modal-imagen" alt="Imagen del Museo" style="max-height: 80vh;">
                </div>
            </div>
        </div>
    </div>

     <!-- Footer -->
    <footer class="footer" th:insert="~{fragmentos/pie :: pie-pagina}"></footer>
</div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Script para el modal de imagen -->
    <script>
        // Actualizar modal con datos de la imagen
        document.addEventListener('DOMContentLoaded', function() {
            const imageModal = document.getElementById('imageModal');
            imageModal.addEventListener('show.bs.modal', function(event) {
                const button = event.relatedTarget;
                const imgSrc = button.getAttribute('data-img');
                
                const modalImage = imageModal.querySelector('.modal-imagen');
                modalImage.src = imgSrc;
            });
        });
        
        // Función para confirmar eliminación
        function confirmarEliminacion(nombreImagen) {
            if (confirm('¿Está seguro que desea eliminar la imagen "' + nombreImagen + '"?')) {
                // Aquí iría la lógica para eliminar la imagen
                alert('Imagen eliminada correctamente');
            }
        }
    </script>
</body>
</html>
