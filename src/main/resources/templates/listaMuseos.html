<!doctype html>
<html lang="es">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Lista de Museos</title>

	<link rel="icon" href="favicon.ico">
	<link
		href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
		rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
	<link th:href="@{/css/estilos.css}" rel="stylesheet">
	<link th:href="@{/css/listas.css}" rel="stylesheet">
</head>

<body>
	<div class="d-flex flex-column min-vh-100">


		<div class="container my-5">

			<!-- Barra de navegación -->
			<header th:insert="~{fragmentos/menu :: menu-principal}"></header>

			<!-- Barra de búsqueda mejorada -->
			<div class="search-jumbotron text-center p-5 mb-5 rounded-4">
				<h1 class="display-5 fw-bold mb-4">¡Descubre experiencias culturales únicas!</h1>
				<p class="lead mb-4">Explora Museos</p>
				<form class="row g-3 justify-content-center" method="get" th:action="@{/museos/search}">
					<div class="col-md-5">
						<div class="input-group input-group-lg">
							<span class="input-group-text"><i class="fas fa-search"></i></span>
							<input type="text" class="form-control" name="nombre" th:value="${nombreBusqueda}"
								placeholder="Buscar museos, exposiciones...">
						</div>
					</div>
					<div class="col-md-3">
						<select class="form-select form-select-lg" name="categoriaId">
							<option th:value="''" th:selected="${categoriaSeleccionada == null}">Todas las categorías
							</option>
							<option th:each="cat : ${categorias}" th:value="${cat.id}" th:text="${cat.nombre}"
								th:selected="${cat.id == categoriaSeleccionada}"></option>

						</select>
					</div>
					<div class="col-md-2">
						<button type="submit" class="btn btn-primary btn-lg w-100">
							<i class="fas fa-search me-2"></i> Buscar
						</button>
					</div>
				</form>
			</div>


			<section>
				<div class="row g-4">

					<th:block th:if="${museos.content.size() == 0}">
						<div class="alert alert-warning text-center" role="alert">
							No se encontraron museos que coincidan con la búsqueda.
						</div>
					</th:block>


					<!-- Museo 1 -->
					<div class="col-md-6 col-lg-4" th:each="museo : ${museos.content}">
						<div class="card h-100 shadow-sm border-0 museo-card">
							<img th:if="${museo.imagen != null}" th:src="@{'/logos/' + ${museo.imagen}}"
								class="card-img-top" alt="Museo de Arte" style="height: 220px; object-fit: cover;">


							<div class="card-body d-flex flex-column">
								<h5 class="card-title fw-bold mb-1" th:text="${museo.nombre}"></h5>
								<p class="card-text text-muted small mb-2">
									<i class="fa fa-location-dot text-danger"></i>
									<span
										th:text="${museo.ubicacion.calle + ' ' + museo.ubicacion.numeroExterior + ', ' + museo.ubicacion.colonia + ', ' + museo.ubicacion.municipio + ', ' + museo.ubicacion.estado + ', ' + museo.ubicacion.codigoPostal}"></span>
								</p>

								<div class="mb-2">
									<span class="badge bg-secondary" th:text="${museo.categoria.nombre}"></span>
								</div>

								<p class="card-text flex-grow-1 mb-3" th:text="${museo.descripcion}"></p>

								<div class="d-flex justify-content-between align-items-center mt-auto">
									<a th:href="@{/museos/detalle(id=${museo.id})}" class="btn btn-purple btn-sm">Ver
										detalles</a>

									<p th:text="${museo.estatus}" class="mb-0"></p>

								

									<a sec:authorize="isAuthenticated() and hasAnyAuthority('USUARIO')"
										class="btn btn-success btn-sm" th:href="@{/voluntariado/nueva(museoId=${museo.id})}" role="button"
										title="Quiero aplicar para esta oferta de trabajo.">Aplicar voluntariado</a>
								</div>
							</div>
						</div>
					</div>


				</div>
			</section>

			<!-- Paginación para muchas imágenes de categorías -->
			<nav th:if="${museos.totalPages > 0}" class="mt-4" aria-label="Paginacion Museos">
				<ul class="pagination justify-content-center">

					<li class="page-item" th:classappend="${museos.number == 0} ? 'disabled'">
						<a class="page-link"
							th:href="@{/museos/search(nombre=${nombreBusqueda}, categoriaId=${categoriaSeleccionada}, page=${museos.number - 1})}">Anterior</a>
					</li>

					<li class="page-item" th:each="i : ${#numbers.sequence(1, museos.totalPages)}"
						th:classappend="${i == museos.number + 1} ? 'active'">
						<a class="page-link"
							th:href="@{/museos/search(nombre=${nombreBusqueda}, categoriaId=${categoriaSeleccionada}, page=${i - 1})}"
							th:text="${i}"></a>
					</li>

					<li class="page-item" th:classappend="${museos.number == museos.totalPages - 1} ? 'disabled'">
						<a class="page-link"
							th:href="@{/museos/search(nombre=${nombreBusqueda}, categoriaId=${categoriaSeleccionada}, page=${museos.number + 1})}">Siguiente</a>
					</li>

				</ul>
			</nav>

		</div>

		<!-- Footer -->
		<footer class="footer" th:insert="~{fragmentos/pie :: pie-pagina}"></footer>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	</div>
</body>

</html>